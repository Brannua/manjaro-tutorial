
## 我安装 ManjaroLinux 的方式

基于 BitTorrent 网络通信协议，使用 qbittorrent 客户端

从 ManjaroLinux 的[官方网站](https://manjaro.org/)下载系统 manjaro-kde-plasma-minimal-lts 的 ISO 镜像，**并检验 ISO 镜像的正确完整性**

然后将该 ISO 镜像烧录到一个 USB-3 接口的 U 盘上，如此你就拥有了一个系统安装 U 盘

---

ISO 镜像的烧录工具推荐：[etcher](https://www.balena.io/etcher/)

当然，也可使用 Linux 的一个 Shell 工具：`dd` 进行 ISO 镜像的烧录

```bash
# 这是 dd 的一个使用范例，各项参数的具体含义请自行使用 man 查询 dd 的 manual_page
sudo dd bs=4M if=/path/to/manjarolinux.iso of=/dev/sdx oflag=sync status=progress
```

---

> 系统安装之前，请做好数据备份，因为系统安装的过程中会**抹除**计算机硬盘中的**所有**数据

开始安装系统：

首先关掉 BIOS 中的 Secure Boot 选项，确保 UEFI boot mode，然后从系统安装 U 盘启动

```bash
# 二次验证 UEFI boot mode 的方式如下，期望输出一堆 efi 变量
ls /sys/firmware/efi/efivars
```

> 为减少系统安装所需的时间，请保持电脑接通电源，且不接入互联网

GPT + 默认分区方式 + 英文系统 + 正确的时区（eg：上海、中国、东八区）

一盏茶的功夫就安装完毕，关机，然后拔掉系统安装 U 盘

## 开机

#### 3 种打开 terminal 的方式

1. konsole: 默认为 ctrl+alt+t

2. 当聚焦于文件资源管理器 dolphin 的窗口时，默认按 f4 打开其内置 terminal

3. 运行 yakuake，默认按 f12 打开其下拉 terminal 面板，初次打开会提示是否需要修改打开 yakuake 下拉面板的快捷键，推荐将快捷键修改为 meta+space

> 然后在系统设置中将 yakuake 设置为开机自启

#### 联网

```bash
timedatectl status
timedatectl set-ntp true # 将系统时间与网络时间进行同步
timedatectl status
```

## 软件包管理

#### pacman

尽可能地只使用官方软件包管理器 pacman 下载安装软件包，因为其从官方的软件仓库下载软件包，都通过了官方的测试，比较稳定有保障

#### AUR & 注意事项

若官方软件仓库中没有我们需要的软件包，那么可以谨慎地从 [AUR](https://aur.archlinux.org/) 中寻找我们需要的软件包

> AUR 是 ArchUser Repository，任何人都可以向其中发布软件包，由于其中的软件包未经官方验证，因此应谨慎使用其中的软件包，比如当你从 AUR 中发现了你需要的软件包，在决定下载安装该软件包之前，你需要先做如下几步

1. 查看该软件包在 AUR 中的详细信息

    1-1. 该软件包的发布者是否在积极维护该软件包 ？

    1-2. 该软件包依赖哪些软件包 ？

    1-3. 评论区有没有用户反映该软件包有 BUG ？有的话解决了吗 ？解决地及时吗 ？

    ...

2. 查看该软件包的官方地址（比如其 github 地址），注意软件包的 star 数量，注意软件包作者的维护积极性，关注 issues 活跃度，以确保该软件包的可用性

3. 在决定将该软件包引入系统之前，备份系统 ！

#### AUR helper

AUR helper 说的就是第三方的软件包管理器，用于从 AUR 中下载安装软件包，比如：[yay](https://github.com/Jguer/yay)

我曾经询问过 yay 的开发者：[Can I just use yay instead of pacman?](https://github.com/Jguer/yay/issues/1601)

## 手动设置软件镜像源

我们之后所需下载安装的软件包，都将获取自我们设置的软件镜像源

编辑文件 `/etc/pacman.d/mirrorlist`，其中有所有可用的软件镜像源，只需将你想使用的软件镜像源放到该文件的第一行，然后保存退出即可

暂时使用中国大陆内地理位置较近的软件镜像源

之后我们会配置网络代理，拥有对全世界互联网的访问能力（这十分必要），进而立即将软件镜像源设置为非人身所在国家且地理位置较近的软件镜像源，然后更新系统：`sudo pacman -Syyu`

---

**关于为什么需要更新系统**

首先，基于 ArchLinux 的一众发行版均采用滚动更新的系统更新方式

这意味着每隔十天半个月，官方就会发布少量的程序更新，也正是因此，从官方网站下载的 ISO 系统镜像未必最新，我们需要在刚安装好系统进入桌面后更新系统，以尝试接收官方已经发布但尚未打包到 ISO 系统镜像中的程序更新）

滚动更新的优点：你可以时刻使用各种程序的最新版本，体验最新特性

滚动更新的缺点：`你需要经常使用你的电脑，每隔十天半个月就使用软件包管理器尝试接收官方发布的程序更新`

> 每次系统更新前，都请备份你的系统 ！！！

静待更新完毕，重启系统，再进行接下来的操作

## 安装微码

[Microcode | Archwiki](https://wiki.archlinux.org/title/Microcode)

```bash
pacman -S intel-ucode # Intel
pacman -S amd-ucode   # AMD
```

## 进阶配置

编辑 `/etc/default/grub` 文件

为便于系统 DEBUG

去掉 `GRUB_CMDLINE_LINUX_DEFAULT` 一行中最后的 `quiet` 参数，并将 `log level` 的数值从 3 改成 5

为提高开关机速度

在同一行加入 `nowatchdog` 参数

保存退出后

`grub-mkconfig -o /boot/grub/grub.cfg`

## 初装 Shell

我使用 [bash](https://en.wikipedia.org/wiki/Bash_(Unix_shell))

所以将系统的终端默认运行的 Shell 程序设置为 bash

然后安装 bash-completion 补全提示工具

```bash
sudo pacman -S bash-completion
```

## 初装 Vim

这可能是世界上最好用的文本编辑器吧（~~我没有说 Emacs 不好的意思~~)

```bash
sudo pacman -S vim
```

## 初装 tmux

终端复用器，还挺好用的

```bash
sudo pacman -S tmux
```

## 初装 git 

git 是 Linux 之父创造的高性能文件版本控制工具（respect ！）

可以执行命令 `git --version` 查看当前系统中 git 的版本

如果系统中未安装 git，那么

```bash
sudo pacman -S git
```

`git config` 有 3 种作用域：--local、--global、--system（具体含义请自行查询 git manual）

下面我们简单地配置一下 git（具体含义也请自行查阅 git manual）

```bash
# 必要配置项
git config --global user.name "your_english_name"
git config --global user.email "your_email"

# 推荐配置项
git config --global init.defaultBranch master
git config --global core.quotepath false
git config --global core.editor vim
```

查看 git 的配置信息，就加 `--list`，git 的进阶配置使用方式会另外编写文章介绍

> https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/
>
> **鉴于此，我决定使用 https + personalAccessToken 的方式验证 git operation in cli，官方也推荐用 https**
>
> **而之前使用的基于 ssh 的验证方式，我目前不使用**

## 配置触摸板手势操作

- 第一步，see [FAQ](https://github.com/JoseExposito/touchegg#faq)

- 第二步，安装核心程序包 [touchegg](https://github.com/JoseExposito/touchegg#arch-linux-manjaro-and-derivatives)

- 第三步，安装图形化客户端 [touche](https://github.com/JoseExposito/touche)

![image-20220304102852504](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/by-picgo/image-20220304102852504.png)

![2-四指轻扫（向上多桌面平铺、向下单桌面平铺、切换桌面）](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/mass/2-四指轻扫（向上多桌面平铺、向下单桌面平铺、切换桌面）.png)

![3-双指捏合缩放](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/mass/3-双指捏合缩放.png)

![4-三指捏合显示所有应用程序](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/mass/4-三指捏合显示所有应用程序.png)

![5-轻敲默认](https://aliyun-oss-lpj.oss-cn-qingdao.aliyuncs.com/images/mass/5-轻敲默认.png)

> 其实这个软件的图形客户端是俺汉化滴嘿嘿 => See [here](https://github.com/JoseExposito/touche/commit/8dd8eae888ff388b8c5715b314d47dc00355e252)

















#### 中文输入法

```bash
sudo pacman -S fcitx5-im fcitx5-chinese-addons        # 输入法框架 & 输入法引擎
sudo pacman -S fcitx5-qt fcitx5-gtk fcitx5-configtool # 依赖和配置工具
sudo pacman -S fcitx5-pinyin-zhwiki                   # 中文维基百科词库

vim ~/.pam_environment

# 写入以下配置，保存退出
GTK_IM_MODULE DEFAULT=fcitx5
QT_IM_MODULE  DEFAULT=fcitx5
XMODIFIERS    DEFAULT=\@im=fcitx5
SDL_IM_MODULE DEFAULT=fcitx5
```

注销或重启系统，应该就可以输入中文了，输入法切换的快捷键默认为：ctrl+space 或 ctrl+shift


#### 开源中文字体及表情

```bash
sudo pacman -S wqy-zenhei noto-fonts-cjk noto-fonts-extra noto-fonts-emoji
```

